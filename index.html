<!-- НАЧАЛО ФИНАЛЬНОЙ ВЕРСИИ index.html -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Development &amp; SEO Services in Tbilisi, Georgia | Digital Craft</title>
    <meta name="description" content="Loading professional web development and SEO services based in Tbilisi. We build high-performance websites for businesses.">

    <!-- ================== САМЫЙ НАДЕЖНЫЙ ЗАГРУЗЧИК РЕСУРСОВ ================== -->
    <script>
      // Это сообщение поможет нам понять, что вы загрузили новую версию файла.
      console.log('ЗАГРУЖЕНА ФИНАЛЬНАЯ ВЕРСИЯ index.html. Если вы видите это, значит кэш не помешал.');
      
      (function() {
        // Определяем полный базовый путь к корню репозитория, чтобы не было ошибок.
        // Например: https://ramashery.github.io/repo-name
        const repoName = window.location.pathname.split('/')[1];
        const basePath = window.location.origin + '/' + repoName;

        // Функция для создания и добавления тегов в <head> с полным, абсолютным путем
        function loadAsset(tag, attributes) {
          const element = document.createElement(tag);
          for (const key in attributes) {
            element.setAttribute(key, attributes[key]);
          }
          document.head.appendChild(element);
        }

        // --- Загружаем все, что нужно для <head> ---
        
        // Загружаем CSS с полным путем
        loadAsset('link', { rel: 'stylesheet', href: basePath + '/style.css' });
        
        // Загружаем Favicon с полным путем
        loadAsset('link', { rel: 'icon', href: basePath + '/favicon.svg', type: 'image/svg+xml' });

        // Загружаем внешние шрифты и скрипты Firebase
        loadAsset('link', { rel: 'preconnect', href: 'https://fonts.googleapis.com' });
        loadAsset('link', { rel: 'preconnect', href: 'https://fonts.gstatic.com', crossorigin: '' });
        loadAsset('link', { href: 'https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap', rel: 'stylesheet' });
        
        loadAsset('script', { src: 'https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js' });
        loadAsset('script', { src: 'https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js' });
        loadAsset('script', { src: 'https://www.gstatic.com/firebasejs/9.15.0/firebase-auth-compat.js' });
        
        // --- Загружаем все, что нужно для <body>, после полной загрузки страницы ---
        window.addEventListener('DOMContentLoaded', function() {
            function loadBodyScript(attributes) {
                const element = document.createElement('script');
                for (const key in attributes) {
                    element.setAttribute(key, attributes[key]);
                }
                document.body.appendChild(element);
            }

            // Загружаем главный скрипт приложения и Метрику с полным путем
            loadBodyScript({ type: 'module', src: basePath + '/main.js' });
            // Файл metrika.js должен лежать в корне репозитория
            loadBodyScript({ src: basePath + '/metrika.js', defer: '' });
        });

      })();
    </script>
    
    <!-- Скрипт-восстановитель URL (остается без изменений) -->
    <script>
      (function(){
        const redirect = sessionStorage.redirect;
        delete sessionStorage.redirect;
        if (redirect) {
          history.replaceState(null, null, redirect);
        }
      })();
    </script>
</head>
<body>
    <!-- Вся структура HTML остается такой же, как и раньше -->
    <noscript>
        <h1>Digital Craft - Web Development &amp; SEO in Tbilisi</h1>
        <p>We create professional, high-performance websites...</p>
    </noscript>
    <div id="loader"><div class="spinner"></div></div>
    <iframe id="custom-background-iframe" title="Custom Background"></iframe>
    <button class="menu-toggle" aria-label="Toggle menu"><span class="bar"></span><span class="bar"></span><span class="bar"></span></button>
    <div class="nav-overlay"><ul class="nav-menu"></ul></div>
    <main></main>
    <footer class="site-footer" id="site-footer"></footer>
    <div id="admin-panel"><!-- ...содержимое админки... --></div>
</body>
</html>

<!-- КОНЕЦ ФИНАЛЬНОЙ ВЕРСИИ index.html -->